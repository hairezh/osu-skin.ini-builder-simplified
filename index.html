<!doctype html>
<html lang="en">
<head>
  <link rel="icon" type="image/png" href="https://i.pinimg.com/1200x/d6/ca/e4/d6cae471e8471dec46c4304104adb4b1.jpg"/>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>skin.ini</title>

  <style>
    :root{
      --bg:#0b0c0f; --fg:#e8e8e8; --muted:#7a7a7a;
      --border:rgba(255,255,255,.08); --panel:rgba(255,255,255,.03);
      --fs:14px; --lh:1.6; --r:6px;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0; background:var(--bg); color:var(--fg);
      font:var(--fs)/var(--lh) ui-monospace, Menlo, Consolas, monospace;
      height:100vh;
    }

    .app{ height:100vh; display:flex; flex-direction:column; }

    .topbar{
      display:flex; gap:8px; flex-wrap:wrap;
      padding:8px 10px; border-bottom:1px solid var(--border);
      background:rgba(255,255,255,.03);
      align-items:center; justify-content:space-between;
    }

    .controls{ display:flex; gap:6px; flex-wrap:wrap; align-items:center; }

    .btn{
      padding:6px 10px;
      border-radius:6px;
      border:1px solid var(--border);
      background:rgba(0,0,0,.25);
      color:var(--muted);
      cursor:pointer;
      font-weight:600;
    }
    .btn.active{
      background:rgba(255,255,255,.08);
      color:var(--fg);
      border-color:rgba(255,255,255,.2);
    }

    .main{
      flex:1;
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:10px;
      padding:10px;
    }

    .panel{
      border:1px solid var(--border);
      border-radius:6px;
      background:rgba(255,255,255,.02);
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }

    .panelHead{
      padding:8px 10px;
      border-bottom:1px solid var(--border);
      font-size:12px;
      color:rgba(232,232,232,.6);
    }

    .panelBody{
      padding:10px;
      overflow:auto;
      flex:1;
    }

    textarea{
      width:100%;
      height:100%;
      resize:none;
      background:rgba(0,0,0,.25);
      border:1px solid var(--border);
      color:var(--fg);
      padding:10px;
      border-radius:6px;
      font:inherit;
    }

    .row{
      display:flex;
      gap:10px;
      align-items:center;
      margin-bottom:8px;
    }

    select{
      background:black;
      color:white;
      border:1px solid var(--border);
      padding:6px;
      border-radius:6px;
    }
  </style>
</head>

<body>
<div class="app">

  <!-- TOP -->
  <div class="topbar">
    <div class="controls">
      <button class="btn active" id="toggle4">4K</button>
      <button class="btn" id="toggle6">6K</button>
      <button class="btn" id="toggle7">7K</button>
    </div>

    <div class="controls">
      <button class="btn" id="downloadIni">Download skin.ini</button>
    </div>
  </div>

  <div class="main">
    <!-- LEFT -->
    <div class="panel">
      <div class="panelHead">Mania</div>
      <div class="panelBody">

        <div class="row">
          <label>Edit keymode</label>
          <select id="mKeysSelect"></select>
        </div>

        <div class="row">
          <label>ColumnWidth</label>
          <input type="number" id="mColWidth" value="70">
        </div>

        <div class="row">
          <label>ColumnSpacing</label>
          <input type="number" id="mColSpacing" value="0">
        </div>

      </div>
    </div>

    <!-- RIGHT -->
    <div class="panel">
      <div class="panelHead">skin.ini preview</div>
      <div class="panelBody">
        <textarea id="preview" readonly></textarea>
      </div>
    </div>
  </div>
</div>

<script>
const $ = id => document.getElementById(id);

const STORAGE_KEY = "skin_modes_active";

/* ===== ACTIVE MODES ===== */
let activeModes = { 4:true, 6:false, 7:false };

let currentKeys = 4;

const modesData = {
  4:{ colW:70, colS:0 },
  6:{ colW:70, colS:0 },
  7:{ colW:70, colS:0 }
};

function refreshModeButtons(){
  [4,6,7].forEach(k=>{
    $("toggle"+k).classList.toggle("active", activeModes[k]);
  });
}

function refreshSelect(){
  const sel = $("mKeysSelect");
  sel.innerHTML = "";
  Object.keys(activeModes).forEach(k=>{
    if(activeModes[k]){
      const o = document.createElement("option");
      o.value = k;
      o.textContent = k+"K";
      sel.appendChild(o);
    }
  });
  if(!activeModes[currentKeys]){
    currentKeys = Number(sel.value);
  }
  sel.value = currentKeys;
}

function genIni(){
  let out = [];
  Object.keys(activeModes).forEach(k=>{
    if(!activeModes[k]) return;
    const m = modesData[k];
    out.push("[Mania]");
    out.push(`Keys: ${k}`);
    out.push(`ColumnWidth: ${Array(k).fill(m.colW).join(",")}`);
    out.push(`ColumnSpacing: ${Array(k-1).fill(m.colS).join(",")}`);
    out.push("");
  });
  return out.join("\n");
}

function updatePreview(){
  modesData[currentKeys].colW = $("mColWidth").value;
  modesData[currentKeys].colS = $("mColSpacing").value;
  $("preview").value = genIni();
  localStorage.setItem(STORAGE_KEY, JSON.stringify(activeModes));
}

[4,6,7].forEach(k=>{
  $("toggle"+k).onclick = ()=>{
    activeModes[k] = !activeModes[k];
    refreshModeButtons();
    refreshSelect();
    updatePreview();
  };
});

$("mKeysSelect").onchange = ()=>{
  currentKeys = Number($("mKeysSelect").value);
  $("mColWidth").value = modesData[currentKeys].colW;
  $("mColSpacing").value = modesData[currentKeys].colS;
};

["mColWidth","mColSpacing"].forEach(id=>{
  $(id).oninput = updatePreview;
});

$("downloadIni").onclick = ()=>{
  const blob = new Blob([$("preview").value],{type:"text/plain"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "skin.ini";
  a.click();
};

/* init */
const saved = localStorage.getItem(STORAGE_KEY);
if(saved) activeModes = JSON.parse(saved);

refreshModeButtons();
refreshSelect();
$("mColWidth").value = modesData[currentKeys].colW;
$("mColSpacing").value = modesData[currentKeys].colS;
updatePreview();
</script>
</body>
</html>
